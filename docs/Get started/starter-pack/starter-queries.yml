- name: Collect failed login attempts
  description: Lists the users at least one failed login attempt and timestamp of failed login. Number of failed login attempts reset to zero after a user successfully logs in.
  query: SELECT users.username, account_policy_data.failed_login_count, account_policy_data.failed_login_timestamp FROM users INNER JOIN account_policy_data using (uid) WHERE account_policy_data.failed_login_count > 0;
  interval: 300 # 5 minutes
  observer_can_run: true
  automations_enabled: false
  platform: darwin,linux,windows
- name: Collect USB devices
  description: Collects the USB devices that are currently connected to macOS and Linux hosts.
  query: SELECT model, vendor FROM usb_devices;
  interval: 3600 # 1 hour
  observer_can_run: false
  automations_enabled: false
  platform: darwin,linux
- name: Get OpenSSL versions
  description: Retrieves the OpenSSL version.
  query: SELECT name AS name, version AS version, 'deb_packages' AS source FROM deb_packages WHERE name LIKE 'openssl%' UNION SELECT name AS name, version AS version, 'apt_sources' AS source FROM apt_sources WHERE name LIKE 'openssl%' UNION SELECT name AS name, version AS version, 'rpm_packages' AS source FROM rpm_packages WHERE name LIKE 'openssl%';
  interval: 86400 # daily
  observer_can_run: true
  automations_enabled: false
  platform: linux
- name: All ARM-based Windows hosts
  description: Collects all ARM-based Windows hosts.
  query: SELECT * FROM os_version WHERE arch LIKE 'ARM%';
  interval: 300 # 5 minutes
  observer_can_run: true
  automations_enabled: false
  platform: windows
- name: All x86-based Windows hosts
  description: Collects all x86-based Windows hosts.
  query: SELECT * FROM os_version WHERE arch NOT LIKE 'ARM%';
  interval: 300 # 5 minutes
  observer_can_run: true
  automations_enabled: false
  platform: windows
- name: Detect if Apple Intelligence is enabled
  automations_enabled: false
  description: Detects if Apple Intelligence has been enabled.
  query: SELECT * FROM plist WHERE path LIKE '/Users/%/Library/Preferences/com.apple.CloudSubscriptionFeatures.optIn.plist';
  interval: 300 # 5 minutes
  observer_can_run: true
  platform: darwin
- name: All debian-based Linux hosts
  automations_enabled: false
  description: Collects all debian-based hosts.
  discard_data: false
  interval: 300
  logging: snapshot
  observer_can_run: true
  platform: linux
  query: SELECT * FROM os_version WHERE platform = 'debian';
- name: All rhel-based (rpm) Linux hosts
  automations_enabled: false
  description: Collects all rhel-based Llinux hosts.
  discard_data: false
  interval: 300
  logging: snapshot
  observer_can_run: true
  platform: linux
  query: SELECT * FROM os_version WHERE platform_like = 'rhel';
